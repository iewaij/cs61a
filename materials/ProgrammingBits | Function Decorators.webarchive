bplist00—_WebMainResource’	
_WebResourceData_WebResourceMIMEType_WebResourceTextEncodingName^WebResourceURL_WebResourceFrameNameOõ±<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<base href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html"><style type="text/css">body { margin-left:0;margin-right:0;margin-top:0; }#google-cache-hdr {background:#f5f5f5 !important;font:13px arial,sans-serif !important;text-align:left !important;color:#202020 !important;border:0 !important;margin:0 !important;border-bottom:1px solid #cecece !important;line-height:16px !important ;padding:16px 28px 24px 28px !important;}#google-cache-hdr * {display:inline !important;font:inherit !important;text-align:inherit !important;color:inherit !important;line-height:inherit !important;background:none !important;border:0 !important;margin:0 !important;padding:0 !important;letter-spacing:0 !important;}#google-cache-hdr a {text-decoration:none !important;color:#1a0dab !important;}#google-cache-hdr a:hover { text-decoration:underline !important; }#google-cache-hdr a:visited { color:#609 !important; }#google-cache-hdr div { display:block !important;margin-top:4px !important; }#google-cache-hdr b {font-weight:bold !important;display:inline-block !important;direction:ltr !important;}</style><style type="text/css">#htmlToothbrush, #bodyToothbrush {overflow:hidden !important;zoom:100% !important}
#htmlToothbrush #bodyToothbrush .parentToothbrush {overflow:visible !important;z-index:auto !important;transform:none !important;-webkit-transform-style:flat !important;transition:none !important;contain:none !important;}
#htmlToothbrush #bodyToothbrush .absoluteToothbrush {position:absolute !important;}
#htmlToothbrush #bodyToothbrush .playerToothbrush {position:fixed !important;top:0px !important;left:1px !important;width:calc(100vw - 2px) !important;height:100vh !important;max-width:none !important;max-height:none !important;min-width:0 !important;min-height:0 !important;margin:0 !important;padding:0 !important;z-index:2147483645 !important;border:none !important;background-color:#000 !important;transform:none !important;}
#htmlToothbrush #bodyToothbrush .playerToothbrush video {object-fit:contain !important;}
#playerControlBtn {visibility:hidden;opacity:0;display:none;transition: all 0.5s ease;cursor: pointer;font: 12px "ÂæÆËΩØÈõÖÈªë";margin:0;width:64px;height:20px;line-height:20px;border:none;text-align: center;position: fixed;z-index:2147483646;background-color: #27A9D8;color: #FFF;} #playerControlBtn:hover {visibility:visible;opacity:1;background-color:#2774D8;}
#playerControlBtn.playerControlBtnCol {width:20px;height:64px;line-height:16px;}
#leftFullStackButton{display:none;position:fixed;width:1px;height:100vh;top:0;left:0;z-index:2147483646;background:#000;}
#rightFullStackButton{display:none;position:fixed;width:1px;height:100vh;top:0;right:0;z-index:2147483646;background:#000;}</style><style type="text/css">
:root .footer > #box[style="width:100%;height:100%;position:fixed;top:0"]
{ display: none !important; }</style></head><body><div id="google-cache-hdr" dir="ltr"><div>ËøôÊòØ Google ÂØπ <a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html" dir="ltr">http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html</a> ÁöÑÁºìÂ≠ò„ÄÇ ËøôÊòØËØ•ÁΩëÈ°µÂú® 2017 Âπ¥ 8 Êúà 20 Êó• 12:17:57 GMT ÁöÑÂø´ÁÖß„ÄÇ </div><div><a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html" dir="ltr">ÂΩìÂâçÈ°µ</a>Âú®Ê≠§ÊúüÈó¥ÂèØËÉΩÂ∑≤ÁªèÊõ¥Êîπ„ÄÇ <a href="http://support.google.com/websearch/bin/answer.py?hl=zh-CN&amp;p=cached&amp;answer=1687222">‰∫ÜËß£ËØ¶ÊÉÖ</a></div><div></div><div><span style="display:inline-block !important;margin-top:8px !important;margin-right:104px !important;white-space:nowrap !important;"><span style="margin-right:28px !important;"><span style="font-weight:bold !important;">ÂÆåÊï¥ÁâàÊú¨</span></span><span style="margin-right:28px !important;"><a href="http://webcache.googleusercontent.com/search?q=cache:1XVsVV4qFMsJ:programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html&amp;num=1&amp;hl=zh-CN&amp;gl=hk&amp;strip=1&amp;vwsrc=0">Á∫ØÊñáÂ≠óÁâàÊú¨</a></span><span style="margin-right:28px !important;"><a href="http://webcache.googleusercontent.com/search?q=cache:1XVsVV4qFMsJ:programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html&amp;num=1&amp;hl=zh-CN&amp;gl=hk&amp;strip=0&amp;vwsrc=1">Êü•ÁúãÊ∫ê‰ª£Á†Å</a></span></span><span style="display:inline-block !important;margin-top:8px !important;color:#717171 !important;">ÊèêÁ§∫ÔºöË¶ÅÂú®Ê≠§È°µÈù¢‰∏äÂø´ÈÄüÊâæÂà∞ÊÇ®ÁöÑÊêúÁ¥¢Â≠óËØçÔºåËØ∑Êåâ <b>Ctrl+F</b> ÊàñËÄÖ <b>‚åò-F</b>ÔºàMacÔºâÔºåÁÑ∂Âêé‰ΩøÁî®Êü•ÊâæÊ†èÊêúÁ¥¢„ÄÇ</span></div></div><div style="position:relative;">


 
 <title>ProgrammingBits | Function Decorators</title>
 <meta http-equiv="Content-Language" content="en">
 <link rel="stylesheet" type="text/css" title="Style" href="http://programmingbits.pythonblogs.com/templates/standard/style.css">
 <!--[if IE ]>
<link rel="stylesheet" type="text/css" title="Style" href="http://programmingbits.pythonblogs.com/templates/standard/style-ie.css" />
<![endif] -->
 <link rel="alternate" type="application/xml" title="RSS 2.0" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/rss20">
 <link rel="alternate" type="application/xml" title="RSS 1.0" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/rss10">
 <link rel="alternate" type="application/xml" title="RSS 0.90" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/rss090">
 <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/atom">  
 <link rel="shortcut icon" type="image/x-icon" href="http://programmingbits.pythonblogs.com/templates/standard/favicon.ico">

       <script type="text/javascript">
<!--
function bb2_addLoadEvent(func) {
	var oldonload = window.onload;
	if (typeof window.onload != 'function') {
		window.onload = func;
	} else {
		window.onload = function() {
			oldonload();
			func();
		}
	}
}

bb2_addLoadEvent(function() {
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1487876897 50.67.13.71';
			document.forms[i].appendChild(myElement);
		}
	}
});
// --></script>
		
  
 
   
<!-- Cached content created: 02/23/17 11:08:17 -->
<div id="Container">
  
<div id="Title"><h1><a href="http://programmingbits.pythonblogs.com/27_programmingbits">ProgrammingBits</a></h1></div>
  
<div id="Subtitle"><p>Exploring Python's awesomeness. By Ariel Ortiz.</p>
</div>

<div id="Subcontainer">  

<div id="Content"> 
   		   		<!-- <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                                   xmlns:dc="http://purl.org/dc/elements/1.1/"
                                   xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"><rdf:Description
                             rdf:about="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html"
                             dc:identifier="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html"
                             dc:title="Function Decorators"
                             trackback:ping="http://www.pythonblogs.com/trackback.php?id=50"/></rdf:RDF> -->
   		
   		<h2>Function Decorators</h2>
				<p class="date">aortiz | 31 January, 2009 09:50</p>

<div>
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>
The Python programming language has an interesting syntactic feature called a <em>decorator</em>. Let's use an example in order to explain how and why you would want to use a Python decorator. 
</p>
<p>
<strong>NOTE:</strong> All Python code examples presented here are based in Python 3.0. Full source code: <a href="http://programmingbits.pythonblogs.com/gallery/27/function_decorators.py">function_decorators.py</a> 
</p>
<p>
Suppose we want to compute the <a href="http://en.wikipedia.org/wiki/Fibonacci_number" target="_blank">Fibonacci numbers</a> using a recursive function<sup>1</sup>. The following function definition does the trick: 
</p>
<p></p>
<table class="python code" style="font-family:monospace;"><tbody><tr class="li1"><td style="width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">1
2
3
4
5
</pre></td><td style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">def</span> fib<span style="color: black;">(</span>n<span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> n <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">(</span><span style="color: #ff4500;">0</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">1</span><span style="color: black;">)</span>:
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span> n
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">else</span>:
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span> fib<span style="color: black;">(</span>n - <span style="color: #ff4500;">1</span><span style="color: black;">)</span> + fib<span style="color: black;">(</span>n - <span style="color: #ff4500;">2</span><span style="color: black;">)</span></pre></td></tr></tbody></table>
<p>
</p><p>
We can now test the function with different input values:&nbsp;
</p>
<p>
</p>
<pre class="code">&gt;&gt;&gt; fib(0)
0
&gt;&gt;&gt; fib(1)
1
&gt;&gt;&gt; fib(4)
3
&gt;&gt;&gt; fib(10)
55
&gt;&gt;&gt; fib(30)
832040
&gt;&gt;&gt; fib(35)
9227465
</pre>
<p>
</p>
<p>
If you've actually typed these examples in a Python shell, you've probably noticed that obtaining a result takes longer for bigger inputs. In order to make it run faster, we can use a technique called <em>memoization</em>. A memoized function stores in a cache the results corresponding to some set
of specific inputs. Later calls, with previously computed inputs, return the
results stored in the cache, thus avoiding their recalculation. This means that the primary
cost of a call with certain parameters is taken care of during the first call made to the
function with those same parameters.
</p>
<p>
Instead of modifiying the <tt>fib</tt> function directly, it's better to write a reusable memoizing function: 
</p>
<p></p>
<table class="python code" style="font-family:monospace;"><tbody><tr class="li1"><td style="width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">1
2
3
4
5
6
7
</pre></td><td style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">def</span> memoize<span style="color: black;">(</span>f<span style="color: black;">)</span>:
&nbsp; &nbsp; cache <span style="color: #66cc66;">=</span> <span style="color: black;">{</span><span style="color: black;">}</span>
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">def</span> helper<span style="color: black;">(</span>x<span style="color: black;">)</span>:
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">if</span> x <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> cache: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cache<span style="color: black;">[</span>x<span style="color: black;">]</span> <span style="color: #66cc66;">=</span> f<span style="color: black;">(</span>x<span style="color: black;">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span> cache<span style="color: black;">[</span>x<span style="color: black;">]</span>
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span> helper</pre></td></tr></tbody></table>
<p>
</p><p>
The <tt>memoize</tt> function wraps another function, called <tt>helper</tt>, which is going to provide additional functionality to the function received through parameter <tt>f</tt>. The <tt>helper</tt> function is actually a <em>lexical closure</em>, that is, a function object that remembers the variable bindings that were in its scope when it was created. In this case, <tt>helper</tt> remembers variables <tt>f</tt> and <tt>cache</tt>, which happen to hold a function object and a dictionary, respectively. The last statement in <tt>memoize</tt> just returns to its caller the <tt>helper</tt> lexical closure. 
</p>
<p>
Type the following code, and you'll notice right away a speed increase when calling <tt>fib</tt>. The speedup can be appreciated even in the very first call because the
memoization immediately boosts all the recursive calls inside <tt>fib</tt>'s
definition.
</p>
<p></p>
<pre class="code">&gt;&gt;&gt; fib = memoize(fib)
&gt;&gt;&gt; fib(50)
12586269025
</pre>
<p>
</p><p>
The assignment in the first line can be read as: the <tt>fib</tt> function is being <em>decorated</em> by the <tt>memoize</tt> function. Because this is such a common programming idiom in Python, there's a special decorator syntax to simplify its use. This syntax was originally inspired by Java's annotations: just above the definition of the function that is to be decorated, place an at sign (@) followed by the name of the decorator function. 
</p>
<p>
In other words, this Python syntax:
</p>
<p></p>
<table class="python code" style="font-family:monospace;"><tbody><tr class="li1"><td style="width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">1
2
3
</pre></td><td style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #66cc66;">@</span>some_decorator
<span style="color: #ff7700;font-weight:bold;">def</span> some_function<span style="color: black;">(</span><span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #808080; font-style: italic;"># function body...</span></pre></td></tr></tbody></table>
<p>
</p><p>
is equivalent to: 
</p>
<p></p>
<table class="python code" style="font-family:monospace;"><tbody><tr class="li1"><td style="width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">1
2
3
</pre></td><td style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">def</span> some_function<span style="color: black;">(</span><span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #808080; font-style: italic;"># function body...</span>
some_function <span style="color: #66cc66;">=</span> some_decorator<span style="color: black;">(</span>some_function<span style="color: black;">)</span></pre></td></tr></tbody></table>
<p>
</p><p>
Most should agree that the @ notation is more readable and less error prone.
</p>
<p>
In order to use the Python decorator with our <em>Fibonacci + memoization</em> example, we would have to rewrite as follows: 
</p>
<p></p>
<table class="python code" style="font-family:monospace;"><tbody><tr class="li1"><td style="width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">1
2
3
4
5
6
</pre></td><td style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">def</span> memoize<span style="color: black;">(</span>f<span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #808080; font-style: italic;"># Same code as before...</span>
&nbsp;
<span style="color: #66cc66;">@</span>memoize 
<span style="color: #ff7700;font-weight:bold;">def</span> fib<span style="color: black;">(</span>n<span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #808080; font-style: italic;"># Same code as before...</span></pre></td></tr></tbody></table>
<p>
</p><p>
The <tt>memoize</tt> function shows the general structure that a typical function decorator should have: it receives a function <em>f</em> as its input parameter, and it returns another function that attaches some additional responsibilities to <em>f</em>.&nbsp; 
</p>
<p>
Another interesting thing about Python decorators is that you can chain two or more together. Let's extend our example in order to incorporate a tracing decorator that will display a message before the decorated function gets called and also when it returns.
</p>
<p></p>
<table class="python code" style="font-family:monospace;"><tbody><tr class="li1"><td style="width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><pre style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">def</span> memoize<span style="color: black;">(</span>f<span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #808080; font-style: italic;"># Same code as before...</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> trace<span style="color: black;">(</span>f<span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">def</span> helper<span style="color: black;">(</span>x<span style="color: black;">)</span>:
&nbsp; &nbsp; &nbsp; &nbsp; call_str <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">"{0}({1})"</span>.<span style="color: black;">format</span><span style="color: black;">(</span>f.__name__<span style="color: #66cc66;">,</span> x<span style="color: black;">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">(</span><span style="color: #483d8b;">"Calling {0} ..."</span>.<span style="color: black;">format</span><span style="color: black;">(</span>call_str<span style="color: black;">)</span><span style="color: black;">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; result <span style="color: #66cc66;">=</span> f<span style="color: black;">(</span>x<span style="color: black;">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">(</span><span style="color: #483d8b;">"... returning from {0} = {1}"</span>.<span style="color: black;">format</span><span style="color: black;">(</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call_str<span style="color: #66cc66;">,</span> result<span style="color: black;">)</span><span style="color: black;">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span> result
&nbsp; &nbsp; <span style="color: #ff7700;font-weight:bold;">return</span> helper
&nbsp;
<span style="color: #66cc66;">@</span>memoize
<span style="color: #66cc66;">@</span>trace
<span style="color: #ff7700;font-weight:bold;">def</span> fib<span style="color: black;">(</span>n<span style="color: black;">)</span>:
&nbsp; &nbsp; <span style="color: #808080; font-style: italic;"># Same code as before...</span></pre></td></tr></tbody></table>
<p>
</p><p>
Notice the use <tt>@memoize</tt> and <tt>@trace</tt> just before the definition of <tt>fib</tt>. Now, when invoking <tt>fib</tt>, first the <tt>memoize</tt> decorator gets called, then the <tt>trace</tt> decorator, and finally the original <tt>fib</tt> code. Check this example: 
</p>
<p></p>
<pre class="code">&gt;&gt;&gt; fib(5)
Calling fib(5) ...
Calling fib(4) ...
Calling fib(3) ...
Calling fib(2) ...
Calling fib(1) ...
... returning from fib(1) = 1
Calling fib(0) ...
... returning from fib(0) = 0
... returning from fib(2) = 1
... returning from fib(3) = 2
... returning from fib(4) = 3
... returning from fib(5) = 5
5
</pre>
<p>
</p><p>
Python has three built-in functions that are intended to be used as function decorators:
</p>
<ul>
	<li><tt>classmethod</tt>: used to indicate that the decorated method is a class method, similar to those in Smalltalk or Ruby.</li>
	<li><tt>staticmethod</tt>: used to indicate that the decorated method is a static method, like those in C++, C# or Java.</li>
	<li><tt>property</tt>: used to decorate methods that will be used to get, set and delete object properties.&nbsp; </li>
</ul>
<p>
It's also worth noting that Python 3.0 not only allows you to decorate functions, but also complete classes. Hopefully, I'll take some time to write about these specific kinds of decorators in a a future post. 
</p>
<p>
<span style="font-size: medium"><strong>Notes</strong></span><span style="font-size: medium"><strong></strong></span>
</p>
<p>
<sup>1</sup> Yes, I know that using recursion to implement the Fibonacci sequence is very inefficient. But that was my intention. I wanted a simple algorithm that produces a perceivable time delay for certain inputs.&nbsp; 
</p>
<p>
<span style="font-size: medium"><strong>Further Reading</strong></span>
</p>
<p>
<a href="http://www.python.org/dev/peps/pep-0318/" target="_blank">PEP: 318 Decorators for Functions and Methods</a> 
</p>
</div>


<p class="footer">
<img src="http://programmingbits.pythonblogs.com/templates/standard/imgs/category.gif" alt=""><a href="http://programmingbits.pythonblogs.com/27_programmingbits/categories/31_programming_techniques.html" title="Category: Programming techniques">Programming techniques</a> | 
<img src="http://programmingbits.pythonblogs.com/templates/standard/imgs/next.gif" alt=""><a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/51_more_on_function_decorators.html" title="Next: More On Function Decorators">Next</a> | <img src="http://programmingbits.pythonblogs.com/templates/standard/imgs/previous.gif" alt=""><a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/48_exploring_pythons_awesomeness.html" title="Previous: Exploring Python's Awesomeness">Previous</a> |  
<img src="http://programmingbits.pythonblogs.com/templates/standard/imgs/comment.gif" alt="">Comments (11) | <img src="http://programmingbits.pythonblogs.com/templates/standard/imgs/trackback.gif" alt="">Trackbacks (0)</p>

<h2 id="comments">Comments</h2>
 
   		<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
							aortiz
		 | 13/02/2009, 13:36
</p>

<div class="commenttext">
           <img src="http://programmingbits.pythonblogs.com/gallery/27/previews/aortiz_glow.jpg" alt="aortiz">
  <link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Hi Christo. I'm glad my post was useful. Thanks for your comment.</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader"> Excellent post.</h3>

<p class="commentposterinfo">
							Emilio Olivares
		 | 31/05/2009, 21:01
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Ariel, I'm from M√©xico myself. What city are you from, and what university do you teach at? </p>
<p>Saludos!</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
							Ariel Ortiz
		 | 31/05/2009, 21:42
</p>

<div class="commenttext">
           <img src="http://programmingbits.pythonblogs.com/gallery/27/previews/aortiz_glow.jpg" alt="aortiz">
  <link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Hi Emilio. I live at Cuautitl√°n Izcalli. I teach at the Tecnol√≥gico de Monterrey, Campus Estado de M√©xico.</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
				<a href="http://www.notalion.com" rel="nofollow">Rodolphe Courtier</a>
		 | 20/06/2009, 12:56
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Thanks for writing this! I ran into decorators while learning Django and I had no idea what they were. They make way more sense now.</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader"> How is x passed to the memoize instance?</h3>

<p class="commentposterinfo">
				<a href="http://jacq.co" rel="nofollow">Jacq</a>
		 | 05/12/2010, 09:48
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Thanks, great explanation of memoization, but I don't understand one thing... </p>
<p>In your example</p>
<p>&gt;&gt;&gt; fib = memoize(fib)<br>
&gt;&gt;&gt; fib(50)<br>
12586269025</p>
<p>how is '50' passed to 'helper'? In other words, what if the original fib() took multiple arguments and memoize() contained multiple functions (e.g. helper1, helper2...)?  Would each different 'helper' function inside memoize() then be passed a complete list of all the arguments passed into the (decorated) fib()?</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
							Mohammed Sami
		 | 25/12/2010, 08:22
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>We can see how the original fib(x) executes, if we decorate it as:</p>
<p>@trace<br>
def fib(n):<br>
    # Same code as before...</p>
<p>and then call fib(x).</p>
<p>Example:<br>
&gt;&gt;&gt;fib(5)<br>
Calling fib(5) ...<br>
Calling fib(4) ...<br>
Calling fib(3) ...<br>
Calling fib(2) ...<br>
Calling fib(1) ...<br>
... returning from fib(1) = 1<br>
Calling fib(0) ...<br>
... returning from fib(0) = 0<br>
... returning from fib(2) = 1<br>
Calling fib(1) ...<br>
... returning from fib(1) = 1<br>
... returning from fib(3) = 2<br>
Calling fib(2) ...<br>
Calling fib(1) ...<br>
... returning from fib(1) = 1<br>
Calling fib(0) ...<br>
... returning from fib(0) = 0<br>
... returning from fib(2) = 1<br>
... returning from fib(4) = 3<br>
Calling fib(3) ...<br>
Calling fib(2) ...<br>
Calling fib(1) ...<br>
... returning from fib(1) = 1<br>
Calling fib(0) ...<br>
... returning from fib(0) = 0<br>
... returning from fib(2) = 1<br>
Calling fib(1) ...<br>
... returning from fib(1) = 1<br>
... returning from fib(3) = 2<br>
... returning from fib(5) = 5<br>
5</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader"> Thunks for your great post.!!</h3>

<p class="commentposterinfo">
				<a href="http://kobito.eden@gmail.com" rel="nofollow">Kei</a>
		 | 06/05/2011, 10:44
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Dear aortiz</p>
<p>It's a very useful and understandable. </p>
<p>I lived in Japanese.<br>
I'm studying python and English now.. </p>
<p>and I am writing to ask for your permission to translate this entry to Japanese and comment  on my blog.</p>
<p>The blog is intended for Japanese beginner learners of python and has no commercial agenda.</p>
<p>I will give credit to ProgrammingBits, of course.</p>
<p>Sincerely,<br>
Kei</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
				<a href="http://www.arielortiz.com/" rel="nofollow">Ariel Ortiz</a>
		 | 06/05/2011, 14:00
</p>

<div class="commenttext">
           <img src="http://programmingbits.pythonblogs.com/gallery/27/previews/aortiz_glow.jpg" alt="aortiz">
  <link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Hello Kei. You may translate this or any other of my entries to Japanese. Thanks for asking.</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
				<a href="http://kobito.eden@gmail.com" rel="nofollow">Kei</a>
		 | 06/05/2011, 21:29
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Dear aortiz</p>
<p>Thank you for your prompt reply and for your permission to use.</p>
<p>I look forward to your future posts too!</p>
<p>Sincerely,<br>
Kei<br>
http://kobito-kobito.blogspot.com/<br>
(almost entries are Japanese.....)</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader"> Lexical Closure</h3>

<p class="commentposterinfo">
							Martin Smith
		 | 18/03/2012, 09:39
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Thank you for this illuminating example.  It definitely carried me a step farther along.</p>
<p>It seems challenging to write a version of memoize that can be used for several different functions at once.</p>
</div>
</div>
	<div class="comment">
<h3 class="commentheader">Re: <em>Function Decorators</em></h3>

<p class="commentposterinfo">
							Asaf
		 | 11/01/2014, 03:26
</p>

<div class="commenttext">
<link rel="stylesheet" type="text/css" href="/plugins/plogeshi/styles/plogeshi.css"><p>Hi </p>
<p>actually showing the sequence as below will be better to understand the code: </p>
<p>Hi</p>
<p>It is worth to also show sequence as<br>
def memoize(f):<br>
    print("memo enter")<br>
    cache = {}<br>
    def helper(x):<br>
        print("memo inner enter")<br>
        if x not in cache:<br>
            cache[x] = f(x)<br>
        print("memo inner exit")<br>
        return cache[x]<br>
    print("memo exit")<br>
    return helper</p>
<p>def trace(f):<br>
    print("trace enter")<br>
    def helper(x):<br>
        #call_str = "{0}({1})".format(f.__name__, x)<br>
        #print("Calling {0} ...".format(call_str))<br>
        print("trace inner enter")<br>
        result = f(x)<br>
        #print("... returning from {0} = {1}".format(call_str, result))<br>
        print("trace inner exit")<br>
        return result<br>
    print("trace exit")<br>
    return helper<br>
@memoize<br>
@trace<br>
def fib(n):<br>
    print("fib enter")<br>
    if n in (0, 1):<br>
        print("fib exit")<br>
        return n<br>
    else:<br>
        print("fib exit")<br>
        return fib(n - 1) + fib(n - 2)<br>
print(fib(5))</p>
<p>trace enter<br>
trace exit<br>
memo enter<br>
memo exit<br>
memo inner enter<br>
trace inner enter<br>
fib enter<br>
fib exit<br>
memo inner enter<br>
trace inner enter<br>
fib enter<br>
fib exit<br>
memo inner enter<br>
trace inner enter<br>
fib enter<br>
fib exit<br>
memo inner enter<br>
trace inner enter<br>
fib enter<br>
fib exit<br>
memo inner enter<br>
trace inner enter<br>
fib enter<br>
fib exit<br>
trace inner exit<br>
memo inner exit<br>
memo inner enter<br>
trace inner enter<br>
fib enter<br>
fib exit<br>
trace inner exit<br>
memo inner exit<br>
trace inner exit<br>
memo inner exit<br>
memo inner enter<br>
memo inner exit<br>
trace inner exit<br>
memo inner exit<br>
memo inner enter<br>
memo inner exit<br>
trace inner exit<br>
memo inner exit<br>
memo inner enter<br>
memo inner exit<br>
trace inner exit<br>
memo inner exit<br>
5</p>
</div>
</div>
				
<div id="CommentForm">
<form id="NewComment" action="http://programmingbits.pythonblogs.com/index.php" method="post">
<fieldset>
<legend>Add comment</legend>
<div><textarea rows="10" cols="40" name="commentText" id="commentText" style="width:100%;"></textarea></div>
<div>
	    <label for="userName">Your name</label><br>
  	<input type="text" name="userName" id="userName" value="" style="width:100%"></div>
	        <div style="margin-top: 2px; margin-bottom: 2px">
    <img src="http://programmingbits.pythonblogs.com/index.php?op=AuthImageShow" style="vertical-align:middle;" width="250px" height="20px" alt="authimage"><br>
    <label for="authImage">Enter single word term described on the image</label><br>
    <input type="text" name="authImage" id="authImage" value="" style="width:100%">
    </div>
    

<div id="Submit"><input id="Add" type="submit" value="Send" name="Add">
<input type="hidden" name="op" value="AddComment">
<input type="hidden" name="articleId" value="50">
<input type="hidden" name="blogId" value="27">
<input type="hidden" name="parentId" value=""></div>
</fieldset>
<input type="hidden" name="bb2_screener_" value="1487876897 50.67.13.71"></form>
</div>
					
 

</div>

<div id="Menu">

  	<h2>About The Author</h2>
  	<div id="AboutMyself">
  	  	<img id="UserPicture" src="http://programmingbits.pythonblogs.com/gallery/27/previews/aortiz_glow.jpg" alt="aortiz">
  	<p></p><p>I'm a computer science educator from Mexico. I've been using Python in my classes since 2001 in order to teach programming language principles, compiler construction, and web development.</p>
<p></p>
  	<div class="clearer">&nbsp;</div>
  	</div>



  	<h2>Menu</h2>
    	<div id="Sections">
    	<ul>
    	<li><a title="Main" href="http://programmingbits.pythonblogs.com/27_programmingbits">Main</a></li>
    	<li><a title="Archives" href="http://programmingbits.pythonblogs.com/27_programmingbits/archives">Archives</a></li>
    	<li><a title="Albums" href="http://programmingbits.pythonblogs.com/27_programmingbits/albums/">Albums</a></li>
        <li><a title="Links" href="http://programmingbits.pythonblogs.com/27_programmingbits/links">Links</a></li>
    	<li><a title="Admin" href="http://programmingbits.pythonblogs.com/admin.php">Admin</a></li>
    	</ul>
    	</div>

    	<h2>Search</h2>
	<div id="Search">
	<form id="search_form" method="get" action="http://programmingbits.pythonblogs.com/index.php">
	<fieldset>
	<label for="searchTerms"><input type="text" id="searchTerms" name="searchTerms" value=""></label>
	<input type="submit" name="Search" value="Search" class="button">
	<input type="hidden" name="op" value="Search">
	<input type="hidden" name="blogId" value="27">
	</fieldset>
	</form>
	</div>

	<h2>Calendar</h2>
    	<div id="Calendar">
    		<table class="calMonth" summary="">
<thead>
<tr class="calMonthNav">
	<th class="calMonthBackward"><a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/201701.html" title="January 2017">¬´</a></th>
	<th class="calMonthCurrent" colspan="5">February 2017</th>
	<th class="calMonthForward"><a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/201703.html" title="March 2017">¬ª</a></th>
</tr>
<tr class="calMonthHeader">
	<th scope="col" abbr="Sunday">Su</th>
	<th scope="col" abbr="Monday">Mo</th>
	<th scope="col" abbr="Tuesday">Tu</th>
	<th scope="col" abbr="Wednesday">We</th>
	<th scope="col" abbr="Thursday">Th</th>
	<th scope="col" abbr="Friday">Fr</th>
	<th scope="col" abbr="Saturday">Sa</th>
</tr>
</thead>
<tbody>
<tr>
	<td class="calMonthDay">&nbsp;</td>
	<td class="calMonthDay">&nbsp;</td>
	<td class="calMonthDay">&nbsp;</td>
	<td class="calMonthDay">1</td>
	<td class="calMonthDay">2</td>
	<td class="calMonthDay">3</td>
	<td class="calMonthDay">4</td>
</tr>
<tr>
	<td class="calMonthDay">5</td>
	<td class="calMonthDay">6</td>
	<td class="calMonthDay">7</td>
	<td class="calMonthDay">8</td>
	<td class="calMonthDay">9</td>
	<td class="calMonthDay">10</td>
	<td class="calMonthDay">11</td>
</tr>
<tr>
	<td class="calMonthDay">12</td>
	<td class="calMonthDay">13</td>
	<td class="calMonthDay">14</td>
	<td class="calMonthDay">15</td>
	<td class="calMonthDay">16</td>
	<td class="calMonthDay">17</td>
	<td class="calMonthDay">18</td>
</tr>
<tr>
	<td class="calMonthDay">19</td>
	<td class="calMonthDay">20</td>
	<td class="calMonthDay">21</td>
	<td class="calMonthDay">22</td>
	<td class="calMonthToday">23</td>
	<td class="calMonthDay">24</td>
	<td class="calMonthDay">25</td>
</tr>
<tr>
	<td class="calMonthDay">26</td>
	<td class="calMonthDay">27</td>
	<td class="calMonthDay">28</td>
	<td class="calMonthDay">&nbsp;</td>
	<td class="calMonthDay">&nbsp;</td>
	<td class="calMonthDay">&nbsp;</td>
	<td class="calMonthDay">&nbsp;</td>
</tr>
</tbody>
</table>

    	</div>

  	<h2>Recently...</h2>
    	<div id="Recently">
    	<ul>
    		        <li><a title="More On Function Decorators" href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/51_more_on_function_decorators.html">More On Function Decorators</a></li>
    		        <li><a title="Function Decorators" href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html">Function Decorators</a></li>
    		        <li><a title="Exploring Python's Awesomeness" href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/48_exploring_pythons_awesomeness.html">Exploring Python's Awesomeness</a></li>
    		    	</ul>
   	</div>

 	<h2>Categories</h2>
    	<div id="Categories">
    	<ul>
    		    	<li><a title="Programming techniques" href="http://programmingbits.pythonblogs.com/27_programmingbits/categories/31_programming_techniques.html">Programming techniques <abbr title="2 posts">[2]</abbr></a></li>
   		    	<li><a title="General" href="http://programmingbits.pythonblogs.com/27_programmingbits/categories/30_general.html">General <abbr title="1 posts">[1]</abbr></a></li>
   		  	</ul>
  	</div>

  	<h2>Syndicate</h2>
    	<div id="Syndicate">
    	<ul>
    	<li><a title="RSS 0.90" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/rss090">RSS 0.90</a></li>
    	<li><a title="RSS 1.0" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/rss10">RSS 1.0</a></li>
    	<li><a title="RSS 2.0" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/rss20">RSS 2.0</a></li>
    	<li><a title="Atom" href="http://programmingbits.pythonblogs.com/27_programmingbits/feeds/atom">Atom</a></li>
    	</ul>
    	</div>
</div>

<div class="clearer">&nbsp;</div>



</div>

<div id="Bottommenu"><a href="http://www.w3.org/WAI/">Accessible</a> and Valid <a href="http://validator.w3.org/check/referer">XHTML 1.0 Strict</a> and <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a></div>


<!-- Please leave the credit intact. Thank you. -->
<div id="Bottom">Powered by <a href="http://www.lifetype.net">LT</a> - Design by <a href="http://www.balearweb.com/">BalearWeb</a></div>

</div>

<script type="text/javascript" src="/js/pythonblogs.js"></script>

</div><tbdiv id="playerControlBtn"></tbdiv><tbdiv id="leftFullStackButton"></tbdiv><tbdiv id="rightFullStackButton"></tbdiv></body></html>Ytext/htmlUUTF-8_µhttp://webcache.googleusercontent.com/search?q=cache:1XVsVV4qFMsJ:programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html+&cd=1&hl=zh-CN&ct=clnk&gl=hkP    ( : P n } îúIúSúYù                           ù